(function(a,c){typeof exports=="object"&&typeof module<"u"?module.exports=c():typeof define=="function"&&define.amd?define(c):(a=typeof globalThis<"u"?globalThis:a||self,a.parseAction=c())})(this,function(){"use strict";const a={Object,Array,Number,Boolean,String},c={process(e){try{if(!e)throw new Error("source is undefined");const t={};this._sortType(t,e);const n=new TextEncoder,r=JSON.stringify(t),o=n.encode(r);return this._adler(o)}catch(t){console.error(t)}},_defaultType(e){const t=e==null?void 0:e.constructor.name;return a[t]()},_adler(e){let t=1,n=0;e=new Uint8Array(e);for(let r=0;r<e.length;r++)t+=e[r],n+=t;return t%=65521,n%=65521,this._hex((n<<16|t)>>>0,8)},_ord(e){if(e.length===2){const t=e.charCodeAt(0),n=e.charCodeAt(1);if(t>=55296&&t<56320&&n>=56320&&n<57344)return(t-55296)*1024+n-56320+65536}return e.charCodeAt(0)},_hex(e,t=2){return e=typeof e=="string"?this._ord(e):e,e.toString(16).padStart(t,"0")},_sortType(e,t){if(t==null)throw new Error("objectHash: value cannot be undefined");return Array.isArray(t)?t=this._array(e,t):typeof t=="object"?t=this._object(e,t):typeof t=="function"&&(t=t.toString()),t},_array(e,t){t=t.slice();for(let n=0;n<t.length;n++){const r=t[n];e=this._defaultType(r),t[n]=this._sortType(e,r)}return t},_object(e,t){const n=Object.keys(t);n.sort();for(let r=0;r<n.length;r++){const o=n[r];e[o]=this._defaultType(t[o]),e[o]=this._sortType(e[o],t[o])}return e}},b=e=>{const t=_({source:e}).actions,n={},r=[];let o=[],l=t[0].path.length;for(let h=0;h<t.length;h++){const s=t[h],d=c.process(s.source),A={path:s.path,id:d};let u=e;if(l!==s.path.length){for(let i=0;i<o.length;i++){const g=t[o[i]];for(let f=0;f<s.path.length;f++)if(s.path[f]!==g.path[f]){o.splice(i,1);break}}o.length&&(A.children=o.slice(),o=[])}const y=s.path.length-1;for(let i=0;i<y;i++){const g=s.path[i];u=u[g]}o.push(h),l=s.path.length,y>-1&&(u[s.path[y]]={_$id:d}),r.push(A),n[d]=s.source}const p=c.process(r);return{items:n,sequence:r,sequenceId:p}},_=({source:e,node:t={path:[]},actions:n=[],lastNode:r=0})=>{e.dsAction&&(e._$a=e.dsAction,delete e.dsAction,e.dsParams&&(e._$p=e.dsParams,delete e.dsParams),n.unshift({path:t.path.slice(),source:e}));const o=Object.keys(e);for(let l=0;l<o.length;l++){const p=o[l],h=e[p];if(o.length>1&&(r=t.path.length),typeof h=="object"){t.path.push(p);const s=_({source:h,node:t,actions:n,lastNode:r});t.path=s.node.path.slice(0,r)}}return{actions:n,node:t}};return b});
//# sourceMappingURL=parse-action.umd.cjs.map
